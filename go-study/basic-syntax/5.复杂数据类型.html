<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>1. 数组 | hx&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/blog/img/logo.png">
    <meta name="description" content="hx&#39;s blog">
    <meta name="keywords" content="blog">
    
    <link rel="preload" href="/blog/assets/css/0.styles.bd89e446.css" as="style"><link rel="preload" href="/blog/assets/js/app.17aef99c.js" as="script"><link rel="preload" href="/blog/assets/js/2.cb836bf6.js" as="script"><link rel="preload" href="/blog/assets/js/1.085f3e10.js" as="script"><link rel="preload" href="/blog/assets/js/71.46a9b726.js" as="script"><link rel="prefetch" href="/blog/assets/js/10.132265ea.js"><link rel="prefetch" href="/blog/assets/js/100.87e266af.js"><link rel="prefetch" href="/blog/assets/js/101.336e1d71.js"><link rel="prefetch" href="/blog/assets/js/102.23c45a7d.js"><link rel="prefetch" href="/blog/assets/js/103.9ef43646.js"><link rel="prefetch" href="/blog/assets/js/104.226a1337.js"><link rel="prefetch" href="/blog/assets/js/105.2b1d886c.js"><link rel="prefetch" href="/blog/assets/js/106.06cec04a.js"><link rel="prefetch" href="/blog/assets/js/107.08ea5478.js"><link rel="prefetch" href="/blog/assets/js/108.d59d457d.js"><link rel="prefetch" href="/blog/assets/js/109.8f2e6072.js"><link rel="prefetch" href="/blog/assets/js/11.e2e1fd76.js"><link rel="prefetch" href="/blog/assets/js/110.e34fcad1.js"><link rel="prefetch" href="/blog/assets/js/111.840b7465.js"><link rel="prefetch" href="/blog/assets/js/112.493ca7af.js"><link rel="prefetch" href="/blog/assets/js/113.db891864.js"><link rel="prefetch" href="/blog/assets/js/114.b46d1481.js"><link rel="prefetch" href="/blog/assets/js/115.c48c2cf3.js"><link rel="prefetch" href="/blog/assets/js/116.c62a2f61.js"><link rel="prefetch" href="/blog/assets/js/117.8f7bf0ad.js"><link rel="prefetch" href="/blog/assets/js/118.65f726f0.js"><link rel="prefetch" href="/blog/assets/js/119.84355618.js"><link rel="prefetch" href="/blog/assets/js/12.96baac6c.js"><link rel="prefetch" href="/blog/assets/js/120.6d334245.js"><link rel="prefetch" href="/blog/assets/js/121.186ee6e8.js"><link rel="prefetch" href="/blog/assets/js/122.e98c1d5f.js"><link rel="prefetch" href="/blog/assets/js/123.89739157.js"><link rel="prefetch" href="/blog/assets/js/124.ad929e7c.js"><link rel="prefetch" href="/blog/assets/js/13.fbabcd1a.js"><link rel="prefetch" href="/blog/assets/js/14.ca9d2157.js"><link rel="prefetch" href="/blog/assets/js/15.b3cb30d2.js"><link rel="prefetch" href="/blog/assets/js/16.5023d750.js"><link rel="prefetch" href="/blog/assets/js/17.32813d1e.js"><link rel="prefetch" href="/blog/assets/js/18.5ff6a1ac.js"><link rel="prefetch" href="/blog/assets/js/19.aa6eb975.js"><link rel="prefetch" href="/blog/assets/js/20.910441bb.js"><link rel="prefetch" href="/blog/assets/js/21.463273f4.js"><link rel="prefetch" href="/blog/assets/js/22.41f6992a.js"><link rel="prefetch" href="/blog/assets/js/23.acb88560.js"><link rel="prefetch" href="/blog/assets/js/24.d919972d.js"><link rel="prefetch" href="/blog/assets/js/25.948301e9.js"><link rel="prefetch" href="/blog/assets/js/26.3df0024e.js"><link rel="prefetch" href="/blog/assets/js/27.08710af5.js"><link rel="prefetch" href="/blog/assets/js/28.002665e7.js"><link rel="prefetch" href="/blog/assets/js/29.fd12f9c0.js"><link rel="prefetch" href="/blog/assets/js/3.272f2022.js"><link rel="prefetch" href="/blog/assets/js/30.2c49756d.js"><link rel="prefetch" href="/blog/assets/js/31.c03c4098.js"><link rel="prefetch" href="/blog/assets/js/32.52e46944.js"><link rel="prefetch" href="/blog/assets/js/33.437d563c.js"><link rel="prefetch" href="/blog/assets/js/34.ba907a65.js"><link rel="prefetch" href="/blog/assets/js/35.3d6ecd51.js"><link rel="prefetch" href="/blog/assets/js/36.4dee6b56.js"><link rel="prefetch" href="/blog/assets/js/37.dc23dca3.js"><link rel="prefetch" href="/blog/assets/js/38.932834e6.js"><link rel="prefetch" href="/blog/assets/js/39.51ed60ff.js"><link rel="prefetch" href="/blog/assets/js/4.334133bf.js"><link rel="prefetch" href="/blog/assets/js/40.ce997613.js"><link rel="prefetch" href="/blog/assets/js/41.4c78ba89.js"><link rel="prefetch" href="/blog/assets/js/42.e30c862b.js"><link rel="prefetch" href="/blog/assets/js/43.9cd590d2.js"><link rel="prefetch" href="/blog/assets/js/44.f1f58583.js"><link rel="prefetch" href="/blog/assets/js/45.55cb9902.js"><link rel="prefetch" href="/blog/assets/js/46.6ce65e52.js"><link rel="prefetch" href="/blog/assets/js/47.0b921444.js"><link rel="prefetch" href="/blog/assets/js/48.a12fcac7.js"><link rel="prefetch" href="/blog/assets/js/49.c45d1ce2.js"><link rel="prefetch" href="/blog/assets/js/5.cd02e7c3.js"><link rel="prefetch" href="/blog/assets/js/50.6c9af9d5.js"><link rel="prefetch" href="/blog/assets/js/51.cc1f531f.js"><link rel="prefetch" href="/blog/assets/js/52.d730ce51.js"><link rel="prefetch" href="/blog/assets/js/53.ff3371f3.js"><link rel="prefetch" href="/blog/assets/js/54.312693e1.js"><link rel="prefetch" href="/blog/assets/js/55.6323f7a9.js"><link rel="prefetch" href="/blog/assets/js/56.fb3138c3.js"><link rel="prefetch" href="/blog/assets/js/57.1eb1c67e.js"><link rel="prefetch" href="/blog/assets/js/58.8d274b37.js"><link rel="prefetch" href="/blog/assets/js/59.7bc03ba2.js"><link rel="prefetch" href="/blog/assets/js/6.e5fe1b30.js"><link rel="prefetch" href="/blog/assets/js/60.fabcb705.js"><link rel="prefetch" href="/blog/assets/js/61.526013ca.js"><link rel="prefetch" href="/blog/assets/js/62.26d018f0.js"><link rel="prefetch" href="/blog/assets/js/63.db1ffe1f.js"><link rel="prefetch" href="/blog/assets/js/64.d0ab1f5a.js"><link rel="prefetch" href="/blog/assets/js/65.0555c9a5.js"><link rel="prefetch" href="/blog/assets/js/66.dc45ca7a.js"><link rel="prefetch" href="/blog/assets/js/67.fd136b72.js"><link rel="prefetch" href="/blog/assets/js/68.3c2a726f.js"><link rel="prefetch" href="/blog/assets/js/69.09eb9f27.js"><link rel="prefetch" href="/blog/assets/js/7.a113ee55.js"><link rel="prefetch" href="/blog/assets/js/70.b01d7c4a.js"><link rel="prefetch" href="/blog/assets/js/72.711192ac.js"><link rel="prefetch" href="/blog/assets/js/73.bfd617cb.js"><link rel="prefetch" href="/blog/assets/js/74.0a3e4d92.js"><link rel="prefetch" href="/blog/assets/js/75.2189e9e9.js"><link rel="prefetch" href="/blog/assets/js/76.75fd4c5a.js"><link rel="prefetch" href="/blog/assets/js/77.ad54a3d9.js"><link rel="prefetch" href="/blog/assets/js/78.0b149934.js"><link rel="prefetch" href="/blog/assets/js/79.e2818b62.js"><link rel="prefetch" href="/blog/assets/js/80.d471139e.js"><link rel="prefetch" href="/blog/assets/js/81.2c8b4887.js"><link rel="prefetch" href="/blog/assets/js/82.3f6e54df.js"><link rel="prefetch" href="/blog/assets/js/83.fc352eb5.js"><link rel="prefetch" href="/blog/assets/js/84.01784d87.js"><link rel="prefetch" href="/blog/assets/js/85.933c1326.js"><link rel="prefetch" href="/blog/assets/js/86.5fc5355d.js"><link rel="prefetch" href="/blog/assets/js/87.834b44f5.js"><link rel="prefetch" href="/blog/assets/js/88.c63cb84e.js"><link rel="prefetch" href="/blog/assets/js/89.41ce46ef.js"><link rel="prefetch" href="/blog/assets/js/90.2af565e9.js"><link rel="prefetch" href="/blog/assets/js/91.34c21365.js"><link rel="prefetch" href="/blog/assets/js/92.dfd4daa9.js"><link rel="prefetch" href="/blog/assets/js/93.419e354f.js"><link rel="prefetch" href="/blog/assets/js/94.b89c5d96.js"><link rel="prefetch" href="/blog/assets/js/95.0ac99a30.js"><link rel="prefetch" href="/blog/assets/js/96.5f057ab1.js"><link rel="prefetch" href="/blog/assets/js/97.cde62186.js"><link rel="prefetch" href="/blog/assets/js/98.65d1a4a1.js"><link rel="prefetch" href="/blog/assets/js/99.3a369f28.js"><link rel="prefetch" href="/blog/assets/js/vendors~docsearch.9268c32e.js">
    <link rel="stylesheet" href="/blog/assets/css/0.styles.bd89e446.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/blog/" class="home-link router-link-active"><img src="/blog/img/logo.png" alt="hx's blog" class="logo"> <span class="site-name can-hide">hx's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"> <a href="https://github.com/returnMaize/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"> <a href="https://github.com/returnMaize/blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>基础篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>红宝书（第四版）</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Vue原理篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工程化篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>性能优化篇</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>go</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/blog/go-study/basic-syntax/1.基础.html" class="sidebar-link">基础</a></li><li><a href="/blog/go-study/basic-syntax/2.变量.html" class="sidebar-link">变量</a></li><li><a href="/blog/go-study/basic-syntax/3.基础类型.html" class="sidebar-link">基础类型</a></li><li><a href="/blog/go-study/basic-syntax/4.指针-类型转换.html" class="sidebar-link">指针-类型转换</a></li><li><a href="/blog/go-study/basic-syntax/5.复杂数据类型.html" class="active sidebar-link">复杂数据类型</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/blog/go-study/basic-syntax/5.复杂数据类型.html#_3-1-直接声明新的切片" class="sidebar-link">3.1 直接声明新的切片</a></li><li class="sidebar-sub-header"><a href="/blog/go-study/basic-syntax/5.复杂数据类型.html#_3-2-使用-make-函数构造切片" class="sidebar-link">3.2 使用 make() 函数构造切片</a></li><li class="sidebar-sub-header"><a href="/blog/go-study/basic-syntax/5.复杂数据类型.html#_3-3-思考题" class="sidebar-link">3.3 思考题</a></li><li class="sidebar-sub-header"><a href="/blog/go-study/basic-syntax/5.复杂数据类型.html#_5-1-遍历map" class="sidebar-link">5.1 遍历map</a></li><li class="sidebar-sub-header"><a href="/blog/go-study/basic-syntax/5.复杂数据类型.html#_5-2-删除" class="sidebar-link">5.2 删除</a></li><li class="sidebar-sub-header"><a href="/blog/go-study/basic-syntax/5.复杂数据类型.html#_5-3-线程安全的map" class="sidebar-link">5.3 线程安全的map</a></li></ul></li><li><a href="/blog/go-study/basic-syntax/6.语句.html" class="sidebar-link">语句</a></li><li><a href="/blog/go-study/basic-syntax/7.函数-defer-错误.html" class="sidebar-link">函数-defer-错误</a></li><li><a href="/blog/go-study/basic-syntax/8.结构体.html" class="sidebar-link">结构体</a></li><li><a href="/blog/go-study/basic-syntax/9.接口-IO.html" class="sidebar-link">接口-IO</a></li><li><a href="/blog/go-study/basic-syntax/10.包.html" class="sidebar-link">包</a></li><li><a href="/blog/go-study/basic-syntax/11.并发-管道-锁.html" class="sidebar-link">并发-管道-锁</a></li><li><a href="/blog/go-study/basic-syntax/12.网络.html" class="sidebar-link">网络</a></li><li><a href="/blog/go-study/basic-syntax/13.mysql-redis.html" class="sidebar-link">mysql-redis</a></li><li><a href="/blog/go-study/basic-lib/01-fmt标准库/01.html" class="sidebar-link">fmt标准库</a></li><li><a href="/blog/go-study/basic-lib/02-os标准库/02.html" class="sidebar-link">os标准库</a></li><li><a href="/blog/go-study/basic-lib/03-time标准库/03.html" class="sidebar-link">time标准库</a></li><li><a href="/blog/go-study/basic-lib/04-log标准库/04.html" class="sidebar-link">log标准库</a></li><li><a href="/blog/go-study/basic-lib/05-errors标准库/05.html" class="sidebar-link">errors标准库</a></li><li><a href="/blog/go-study/basic-lib/06-bytes标准库/06.html" class="sidebar-link">bytes标准库</a></li><li><a href="/blog/go-study/basic-lib/07-io标准库/07.html" class="sidebar-link">io标准库</a></li><li><a href="/blog/go-study/basic-lib/08-ioutil标准库/08.html" class="sidebar-link">ioutil标准库</a></li><li><a href="/blog/go-study/basic-lib/09-bufio标准库/09.html" class="sidebar-link">bufio标准库</a></li><li><a href="/blog/go-study/basic-lib/10-builtin标准库/10.html" class="sidebar-link">builtin标准库</a></li><li><a href="/blog/go-study/basic-lib/11-json标准库/11.html" class="sidebar-link">json标准库</a></li><li><a href="/blog/go-study/basic-lib/12-sort标准库/12.html" class="sidebar-link">sort标准库</a></li><li><a href="/blog/go-study/basic-lib/13-math标准库/13.html" class="sidebar-link">math标准库</a></li><li><a href="/blog/go-study/basic-lib/14-flag标准库/14.html" class="sidebar-link">flag标准库</a></li><li><a href="/blog/go-study/basic-lib/15-runtime标准库/15.html" class="sidebar-link">runtime标准库</a></li><li><a href="/blog/go-study/basic-lib/16-context标准库/16.html" class="sidebar-link">context标准库</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="_1-数组"><a href="#_1-数组" class="header-anchor">#</a> 1. 数组</h1> <p>数组是一个由固定长度的特定类型元素组成的序列，一个数组可以由零个或多个元素组成。</p> <p><strong>因为数组的长度是固定的，所以在Go语言中很少直接使用数组。</strong></p> <p><strong>Go语言数组的声明：</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">var</span> 数组变量名 <span class="token punctuation">[</span>元素数量<span class="token punctuation">]</span>Type
</code></pre></div><ul><li>数组变量名：数组声明及使用时的变量名。</li> <li>元素数量：数组的元素数量，可以是一个表达式，但最终通过编译期计算的结果必须是整型数值，元素数量不能含有到运行时才能确认大小的数值。</li> <li>Type：可以是任意基本类型，包括数组本身，类型为数组本身时，可以实现多维数组。</li></ul> <p>例子：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">//默认数组中的值是类型的默认值</span>
<span class="token keyword">var</span> arr <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span>
</code></pre></div><p><strong>从数组中取值：</strong></p> <ol><li><p>通过索引下标取值，索引从0开始</p> <div class="language-go extra-class"><pre class="language-go"><code>	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>for range获取</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">for</span> index<span class="token punctuation">,</span>value <span class="token operator">:=</span> <span class="token keyword">range</span> arr<span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;索引:%d,值：%d \n&quot;</span><span class="token punctuation">,</span>index<span class="token punctuation">,</span>value<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <p><strong>给数组赋值:</strong></p> <ol><li><p>初始化的时候赋值</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">var</span> arr <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span>
<span class="token comment">//如果第三个不赋值，就是默认值0</span>
<span class="token keyword">var</span> arr <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">}</span>
<span class="token comment">//可以使用简短声明</span>
arr <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span>
<span class="token comment">//如果不写数据数量，而使用...，表示数组的长度是根据初始化值的个数来计算</span>
arr <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span>
</code></pre></div></li> <li><p>通过索引下标赋值</p> <div class="language-go extra-class"><pre class="language-go"><code>	<span class="token keyword">var</span> arr <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span>
	arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">5</span>
	arr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">6</span>
	arr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">7</span>
</code></pre></div></li></ol> <blockquote><p>一定要注意，数组是定长的，不可更改，在编译阶段就决定了</p></blockquote> <p><code>小技巧：</code> 如果觉的每次写 <code>[3]int</code> 有点麻烦，你可以为 <code>[3]int</code> 定义一个新的类型。</p> <div class="language-go extra-class"><pre class="language-go"><code>	<span class="token keyword">type</span> arr3 <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span>
	<span class="token comment">//这样每次用arr3 代替[3]int，注意前面学过 定义一个类型后 arr3就是一个新的类型</span>
	<span class="token keyword">var</span> arr arr3
	arr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">2</span>
	<span class="token keyword">for</span> index<span class="token punctuation">,</span>value <span class="token operator">:=</span> <span class="token keyword">range</span> arr<span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;索引:%d,值：%d \n&quot;</span><span class="token punctuation">,</span>index<span class="token punctuation">,</span>value<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>如果想要只初始化第三个值怎么写？</strong></p> <div class="language-go extra-class"><pre class="language-go"><code>	<span class="token comment">//2 给索引为2的赋值 ，所以结果是 0,0,3</span>
	arr <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">2</span><span class="token punctuation">:</span><span class="token number">3</span><span class="token punctuation">}</span>
	<span class="token keyword">for</span> index<span class="token punctuation">,</span>value <span class="token operator">:=</span> <span class="token keyword">range</span> arr<span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;索引:%d,值：%d \n&quot;</span><span class="token punctuation">,</span>index<span class="token punctuation">,</span>value<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
</code></pre></div><p><strong>数组比较</strong></p> <p>如果两个数组类型相同（包括数组的长度，数组中元素的类型）的情况下，我们可以直接通过较运算符（<code>==</code>和<code>!=</code>）来判断两个数组是否相等，只有当两个数组的所有元素都是相等的时候数组才是相等的，不能比较两个类型不同的数组，否则程序将无法完成编译。</p> <div class="language-go extra-class"><pre class="language-go"><code>a <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span>
b <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span>
c <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a <span class="token operator">==</span> b<span class="token punctuation">,</span> a <span class="token operator">==</span> c<span class="token punctuation">,</span> b <span class="token operator">==</span> c<span class="token punctuation">)</span> <span class="token comment">// &quot;true false false&quot;</span>
d <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">}</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a <span class="token operator">==</span> d<span class="token punctuation">)</span> <span class="token comment">// 编译错误：无法比较 [2]int == [3]int</span>
</code></pre></div><h1 id="_2-多维数组"><a href="#_2-多维数组" class="header-anchor">#</a> 2. 多维数组</h1> <p>Go语言中允许使用多维数组，因为数组属于值类型，所以多维数组的所有维度都会在创建时自动初始化零值，多维数组尤其适合管理具有父子关系或者与坐标系相关联的数据。</p> <p>声明多维数组的语法如下所示：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">//array_name 为数组的名字，array_type 为数组的类型，size1、size2 等等为数组每一维度的长度。</span>
<span class="token keyword">var</span> array_name <span class="token punctuation">[</span>size1<span class="token punctuation">]</span><span class="token punctuation">[</span>size2<span class="token punctuation">]</span><span class="token operator">...</span><span class="token punctuation">[</span>sizen<span class="token punctuation">]</span> array_type
</code></pre></div><p>二维数组是最简单的多维数组，二维数组本质上是由多个一维数组组成的。</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// 声明一个二维整型数组，两个维度的长度分别是 4 和 2</span>
<span class="token keyword">var</span> array <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token builtin">int</span>
<span class="token comment">// 使用数组字面量来声明并初始化一个二维整型数组</span>
array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">31</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token comment">// 声明并初始化数组中索引为 1 和 3 的元素</span>
array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">41</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token comment">// 声明并初始化数组中指定的元素</span>
array <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">0</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">:</span> <span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">:</span> <span class="token number">41</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
</code></pre></div><p>取值：</p> <ol><li><p>通过索引下标取值</p> <div class="language-go extra-class"><pre class="language-go"><code>fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div></li> <li><p>循环取值</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">for</span> index<span class="token punctuation">,</span>value <span class="token operator">:=</span> <span class="token keyword">range</span> array<span class="token punctuation">{</span>
		fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;索引:%d,值：%d \n&quot;</span><span class="token punctuation">,</span>index<span class="token punctuation">,</span>value<span class="token punctuation">)</span>
	<span class="token punctuation">}</span>
</code></pre></div></li></ol> <p><strong>赋值：</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// 声明一个 2×2 的二维整型数组</span>
<span class="token keyword">var</span> array <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token builtin">int</span>
<span class="token comment">// 设置每个元素的整型值</span>
array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10</span>
array<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">20</span>
array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">30</span>
array<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">40</span>
</code></pre></div><p>只要类型一致，就可以将多维数组互相赋值，如下所示，多维数组的类型包括每一维度的长度以及存储在元素中数据的类型：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// 声明两个二维整型数组 [2]int [2]int</span>
<span class="token keyword">var</span> array1 <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token builtin">int</span>  
<span class="token keyword">var</span> array2 <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token builtin">int</span>
<span class="token comment">// 为array2的每个元素赋值</span>
array2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">10</span>
array2<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">20</span>
array2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">30</span>
array2<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">40</span>
<span class="token comment">// 将 array2 的值复制给 array1</span>
array1 <span class="token operator">=</span> array2
</code></pre></div><p>因为数组中每个元素都是一个值，所以可以独立复制某个维度，如下所示：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// 将 array1 的索引为 1 的维度复制到一个同类型的新数组里</span>
<span class="token keyword">var</span> array3 <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token builtin">int</span> <span class="token operator">=</span> array1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
<span class="token comment">// 将数组中指定的整型值复制到新的整型变量里</span>
<span class="token keyword">var</span> value <span class="token builtin">int</span> <span class="token operator">=</span> array1<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
</code></pre></div><h1 id="_3-切片"><a href="#_3-切片" class="header-anchor">#</a> 3. 切片</h1> <p><code>切片（Slice）</code>与数组一样，也是可以容纳若干类型相同的元素的容器。</p> <p>与数组不同的是，无法通过切片类型来确定其值的长度。</p> <p>每个切片值都会将数组作为其底层数据结构。</p> <p>我们也把这样的数组称为<code>切片的底层数组</code>。</p> <p><code>切片（slice）</code>是对数组的一个连续片段的引用，所以切片是一个引用类型。</p> <p>这个片段可以是<code>整个数组</code>，也可以是由起始和终止索引标识的一些<code>项的子集</code>，需要注意的是，<code>终止索引标识的项</code>不包括在切片内(左闭右开的区间)。</p> <p>Go语言中切片的内部结构包含<code>地址</code>、<code>大小</code>和<code>容量</code>，切片一般用于快速地操作一块数据集合。</p> <p><strong>从连续内存区域生成切片是常见的操作，格式如下：</strong></p> <div class="language-go extra-class"><pre class="language-go"><code>slice <span class="token punctuation">[</span>开始位置 <span class="token punctuation">:</span> 结束位置<span class="token punctuation">]</span>
</code></pre></div><p>语法说明如下：</p> <ul><li>slice：表示目标切片对象；</li> <li>开始位置：对应目标切片对象的索引；</li> <li>结束位置：对应目标切片的结束索引。</li></ul> <p><strong>从数组生成切片，代码如下：</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">var</span> a  <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>
<span class="token comment">//a[1:2] 生成了一个新的切片</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>从数组或切片生成新的切片拥有如下特性：</p> <ul><li>取出的元素数量为：结束位置 - 开始位置；</li> <li>取出元素不包含结束位置对应的索引，切片最后一个元素使用 slice[len(slice)] 获取；</li> <li>当缺省开始位置时，表示从连续区域开头到结束位置<code>(a[:2])</code>；</li> <li>当缺省结束位置时，表示从开始位置到整个连续区域末尾<code>(a[0:])</code>；</li> <li>两者同时缺省时，与切片本身等效<code>(a[:])</code>；</li> <li>两者同时为 0 时，等效于空切片，一般用于切片复位<code>(a[0:0])</code>。</li></ul> <p><strong>注意：超界会报运行时错误，比如数组长度为3，则结束位置最大只能为3</strong></p> <blockquote><p>切片在指针的基础上增加了大小，约束了切片对应的内存区域，切片使用中无法对切片内部的地址和大小进行手动调整，因此切片比指针更安全、强大。</p></blockquote> <p><strong>示例</strong></p> <blockquote><p>切片和数组密不可分，如果将数组理解为一栋办公楼，那么切片就是把不同的连续楼层出租给使用者，出租的过程需要选择开始楼层和结束楼层，这个过程就会生成切片</p></blockquote> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">var</span> highRiseBuilding <span class="token punctuation">[</span><span class="token number">30</span><span class="token punctuation">]</span><span class="token builtin">int</span>
<span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">30</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
     highRiseBuilding<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span>
<span class="token punctuation">}</span>
<span class="token comment">// 区间</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>highRiseBuilding<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">:</span><span class="token number">15</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 中间到尾部的所有元素</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>highRiseBuilding<span class="token punctuation">[</span><span class="token number">20</span><span class="token punctuation">:</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 开头到中间指定位置的所有元素</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>highRiseBuilding<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_3-1-直接声明新的切片"><a href="#_3-1-直接声明新的切片" class="header-anchor">#</a> 3.1 直接声明新的切片</h2> <p>除了可以从原有的数组或者切片中生成切片外，也可以<code>声明一个新的切片</code>，<code>每一种类型都可以拥有其切片类型</code>，表示多个相同类型元素的连续集合。</p> <p><strong>切片类型声明格式如下：</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">//name 表示切片的变量名，Type 表示切片对应的元素类型。</span>
<span class="token keyword">var</span> name <span class="token punctuation">[</span><span class="token punctuation">]</span>Type
</code></pre></div><div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// 声明字符串切片</span>
<span class="token keyword">var</span> strList <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
<span class="token comment">// 声明整型切片</span>
<span class="token keyword">var</span> numList <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>
<span class="token comment">// 声明一个空切片</span>
<span class="token keyword">var</span> numListEmpty <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token comment">// 输出3个切片</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>strList<span class="token punctuation">,</span> numList<span class="token punctuation">,</span> numListEmpty<span class="token punctuation">)</span>
<span class="token comment">// 输出3个切片大小</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>strList<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>numList<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>numListEmpty<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">// 切片判定空的结果</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>strList <span class="token operator">==</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>numList <span class="token operator">==</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>numListEmpty <span class="token operator">==</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>切片是动态结构，只能与 nil 判定相等，不能互相判定相等。声明新的切片后，可以使用 append() 函数向切片中添加元素。</strong></p> <div class="language-go extra-class"><pre class="language-go"><code>	<span class="token keyword">var</span> strList <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">string</span>
	<span class="token comment">// 追加一个元素</span>
	strList <span class="token operator">=</span> <span class="token function">append</span><span class="token punctuation">(</span>strList<span class="token punctuation">,</span><span class="token string">&quot;ms的go教程&quot;</span><span class="token punctuation">)</span>
	fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>strList<span class="token punctuation">)</span>
</code></pre></div><h2 id="_3-2-使用-make-函数构造切片"><a href="#_3-2-使用-make-函数构造切片" class="header-anchor">#</a> 3.2 使用 make() 函数构造切片</h2> <p>如果需要动态地创建一个切片，可以使用 make() 内建函数，格式如下：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token function">make</span><span class="token punctuation">(</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>Type<span class="token punctuation">,</span> size<span class="token punctuation">,</span> <span class="token builtin">cap</span> <span class="token punctuation">)</span>
</code></pre></div><p><code>Type</code> 是指切片的元素类型，<code>size</code> 指的是为这个类型分配多少个元素，<code>cap</code>为预分配的元素数量，这个值设定后不影响 size，只是能提前分配空间，<code>降低多次分配空间造成的性能问题</code>。</p> <div class="language-go extra-class"><pre class="language-go"><code>a <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
b <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span>
<span class="token comment">//容量不会影响当前的元素个数，因此 a 和 b 取 len 都是 2</span>
<span class="token comment">//但如果我们给a 追加一个 a的长度就会变为3</span>
fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">len</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><blockquote><p>使用 make() 函数生成的切片一定发生了内存分配操作，但给定开始与结束位置（包括切片复位）的切片只是将新的切片结构指向已经分配好的内存区域，设定开始与结束位置，不会发生内存分配操作。</p></blockquote> <h2 id="_3-3-思考题"><a href="#_3-3-思考题" class="header-anchor">#</a> 3.3 思考题</h2> <div class="language-go extra-class"><pre class="language-go"><code>	<span class="token keyword">var</span> numbers4 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">}</span>
	myslice <span class="token operator">:=</span> numbers4<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">]</span>
	<span class="token comment">//这打印出来长度为2</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;myslice为 %d, 其长度为: %d\n&quot;</span><span class="token punctuation">,</span> myslice<span class="token punctuation">,</span> <span class="token function">len</span><span class="token punctuation">(</span>myslice<span class="token punctuation">)</span><span class="token punctuation">)</span>
	myslice <span class="token operator">=</span> myslice<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token function">cap</span><span class="token punctuation">(</span>myslice<span class="token punctuation">)</span><span class="token punctuation">]</span>
	<span class="token comment">//为什么 myslice 的长度为2，却能访问到第四个元素</span>
	fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;myslice的第四个元素为: %d&quot;</span><span class="token punctuation">,</span> myslice<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><h1 id="_4-切片复制"><a href="#_4-切片复制" class="header-anchor">#</a> 4. 切片复制</h1> <p>Go语言的内置函数 copy() 可以将一个数组切片复制到另一个数组切片中，如果加入的两个数组切片不一样大，就会按照其中较小的那个数组切片的元素个数进行复制。</p> <p>copy() 函数的使用格式如下：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token function">copy</span><span class="token punctuation">(</span> destSlice<span class="token punctuation">,</span> srcSlice <span class="token punctuation">[</span><span class="token punctuation">]</span>T<span class="token punctuation">)</span> <span class="token builtin">int</span>
</code></pre></div><p>其中 <code>srcSlice</code>为数据来源切片，<code>destSlice</code>为复制的目标（也就是将 srcSlice 复制到 destSlice），<code>目标切片必须分配过空间且足够承载复制的元素个数</code>，并且来源和目标的<code>类型必须一致</code>，copy() 函数的返回值表示实际发生复制的元素个数。</p> <p>下面的代码展示了使用 copy() 函数将一个切片复制到另一个切片的过程：</p> <div class="language-go extra-class"><pre class="language-go"><code>slice1 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">}</span>
slice2 <span class="token operator">:=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">}</span>
<span class="token function">copy</span><span class="token punctuation">(</span>slice2<span class="token punctuation">,</span> slice1<span class="token punctuation">)</span> <span class="token comment">// 只会复制slice1的前3个元素到slice2中</span>
<span class="token function">copy</span><span class="token punctuation">(</span>slice1<span class="token punctuation">,</span> slice2<span class="token punctuation">)</span> <span class="token comment">// 只会复制slice2的3个元素到slice1的前3个位置</span>
</code></pre></div><p><strong>切片的引用和复制操作对切片元素的影响:</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置元素数量为1000</span>
    <span class="token keyword">const</span> elementCount <span class="token operator">=</span> <span class="token number">1000</span>
    <span class="token comment">// 预分配足够多的元素切片</span>
    srcData <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> elementCount<span class="token punctuation">)</span>
    <span class="token comment">// 将切片赋值</span>
    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> elementCount<span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
        srcData<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> i
    <span class="token punctuation">}</span>
    <span class="token comment">// 引用切片数据 切片不会因为等号操作进行元素的复制</span>
    refData <span class="token operator">:=</span> srcData
    <span class="token comment">// 预分配足够多的元素切片</span>
    copyData <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> elementCount<span class="token punctuation">)</span>
    <span class="token comment">// 将数据复制到新的切片空间中</span>
    <span class="token function">copy</span><span class="token punctuation">(</span>copyData<span class="token punctuation">,</span> srcData<span class="token punctuation">)</span>
    <span class="token comment">// 修改原始数据的第一个元素</span>
    srcData<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">999</span>
    <span class="token comment">// 打印引用切片的第一个元素 引用数据的第一个元素将会发生变化</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>refData<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment">// 打印复制切片的第一个和最后一个元素 由于数据是复制的，因此不会发生变化。</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>copyData<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> copyData<span class="token punctuation">[</span>elementCount<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token comment">// 复制原始数据从4到6(不包含)</span>
    <span class="token function">copy</span><span class="token punctuation">(</span>copyData<span class="token punctuation">,</span> srcData<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> i <span class="token operator">:=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> <span class="token number">5</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d &quot;</span><span class="token punctuation">,</span> copyData<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h1 id="_5-map"><a href="#_5-map" class="header-anchor">#</a> 5. map</h1> <p>map 是一种无序的<code>键值对</code>的集合。</p> <p>map 最重要的一点是通过 key 来快速检索数据，key 类似于索引，指向数据的值。</p> <p>map 是一种集合，所以我们可以像迭代数组和切片那样迭代它。不过，map 是无序的，我们无法决定它的返回顺序，这是因为 map 是使用 hash 表来实现的。</p> <p>map 是引用类型，可以使用如下方式声明：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">//[keytype] 和 valuetype 之间允许有空格。</span>
<span class="token keyword">var</span> mapname <span class="token keyword">map</span><span class="token punctuation">[</span>keytype<span class="token punctuation">]</span>valuetype
</code></pre></div><p>其中：</p> <ul><li>mapname 为 map 的变量名。</li> <li>keytype 为键类型。</li> <li>valuetype 是键对应的值类型。</li></ul> <blockquote><p>在声明的时候不需要知道 map 的长度，因为 map 是可以动态增长的，未初始化的 map 的值是 nil，使用函数 len() 可以获取 map 中 键值对的数目。</p></blockquote> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> mapLit <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span>
    <span class="token keyword">var</span> mapAssigned <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span>
    mapLit <span class="token operator">=</span> <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">{</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&quot;two&quot;</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">}</span>
    mapAssigned <span class="token operator">=</span> mapLit
    <span class="token comment">//mapAssigned 是 mapList 的引用，对 mapAssigned 的修改也会影响到 mapList 的值。</span>
    mapAssigned<span class="token punctuation">[</span><span class="token string">&quot;two&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">3</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Map literal at \&quot;one\&quot; is: %d\n&quot;</span><span class="token punctuation">,</span> mapLit<span class="token punctuation">[</span><span class="token string">&quot;one&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Map assigned at \&quot;two\&quot; is: %d\n&quot;</span><span class="token punctuation">,</span> mapLit<span class="token punctuation">[</span><span class="token string">&quot;two&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;Map literal at \&quot;ten\&quot; is: %d\n&quot;</span><span class="token punctuation">,</span> mapLit<span class="token punctuation">[</span><span class="token string">&quot;ten&quot;</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>map的另外一种创建方式：</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span>keytype<span class="token punctuation">]</span>valuetype<span class="token punctuation">)</span>
</code></pre></div><p><strong>切记不要使用new创建map，否则会得到一个空引用的指针</strong></p> <p>map 可以根据新增的 key-value 动态的伸缩，因此它不存在固定长度或者最大限制，但是也可以选择标明 map 的初始容量 capacity，格式如下：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span>keytype<span class="token punctuation">]</span>valuetype<span class="token punctuation">,</span> <span class="token builtin">cap</span><span class="token punctuation">)</span>
</code></pre></div><p>例如：</p> <div class="language-go extra-class"><pre class="language-go"><code>map2 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
</code></pre></div><p><code>当 map 增长到容量上限的时候，如果再增加新的 key-value，map 的大小会自动加 1，所以出于性能的考虑，对于大的 map 或者会快速扩张的 map，即使只是大概知道容量，也最好先标明。</code></p> <p><strong>既然一个 key 只能对应一个 value，而 value 又是一个原始类型，那么如果一个 key 要对应多个值怎么办？</strong></p> <p>答案是：使用<code>切片</code></p> <p>例如，当我们要处理 unix 机器上的所有进程，以父进程（pid 为整形）作为 key，所有的子进程（以所有子进程的 pid 组成的切片）作为 value。</p> <p>通过将 value 定义为 []int 类型或者其他类型的切片，就可以优雅的解决这个问题，示例代码如下所示：</p> <div class="language-go extra-class"><pre class="language-go"><code>mp1 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span>
mp2 <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token operator">*</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_5-1-遍历map"><a href="#_5-1-遍历map" class="header-anchor">#</a> 5.1 遍历map</h2> <p>map 的遍历过程使用 for range 循环完成，代码如下：</p> <div class="language-go extra-class"><pre class="language-go"><code>scene <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span>
scene<span class="token punctuation">[</span><span class="token string">&quot;cat&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">66</span>
scene<span class="token punctuation">[</span><span class="token string">&quot;dog&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">4</span>
scene<span class="token punctuation">[</span><span class="token string">&quot;pig&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">960</span>
<span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> scene <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>注意：map是无序的，不要期望 map 在遍历时返回某种期望顺序的结果</strong></p> <h2 id="_5-2-删除"><a href="#_5-2-删除" class="header-anchor">#</a> 5.2 删除</h2> <p>使用 delete() 内建函数从 map 中删除一组键值对，delete() 函数的格式如下：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token function">delete</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">,</span> 键<span class="token punctuation">)</span>
</code></pre></div><p>map 为要删除的 map 实例，键为要删除的 map 中键值对的键。</p> <div class="language-go extra-class"><pre class="language-go"><code>scene <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">string</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span>
<span class="token comment">// 准备map数据</span>
scene<span class="token punctuation">[</span><span class="token string">&quot;cat&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">66</span>
scene<span class="token punctuation">[</span><span class="token string">&quot;dog&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">4</span>
scene<span class="token punctuation">[</span><span class="token string">&quot;pig&quot;</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">960</span>
<span class="token function">delete</span><span class="token punctuation">(</span>scene<span class="token punctuation">,</span> <span class="token string">&quot;dog&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> k<span class="token punctuation">,</span> v <span class="token operator">:=</span> <span class="token keyword">range</span> scene <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>Go语言中并没有为 map 提供任何清空所有元素的函数、方法，清空 map 的唯一办法就是重新 make 一个新的 map，不用担心垃圾回收的效率，Go语言中的并行垃圾回收效率比写一个清空函数要高效的多。</strong></p> <p><strong>注意map 在并发情况下，只读是线程安全的，同时读写是线程不安全的。</strong></p> <h2 id="_5-3-线程安全的map"><a href="#_5-3-线程安全的map" class="header-anchor">#</a> 5.3 线程安全的map</h2> <p>并发情况下读写 map 时会出现问题，代码如下：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">// 创建一个int到int的映射</span>
m <span class="token operator">:=</span> <span class="token function">make</span><span class="token punctuation">(</span><span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">int</span><span class="token punctuation">)</span>
<span class="token comment">// 开启一段并发代码</span>
<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 不停地对map进行写入</span>
    <span class="token keyword">for</span> <span class="token punctuation">{</span>
        m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 开启一段并发代码</span>
<span class="token keyword">go</span> <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 不停地对map进行读取</span>
    <span class="token keyword">for</span> <span class="token punctuation">{</span>
        <span class="token boolean">_</span> <span class="token operator">=</span> m<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// 无限循环, 让并发程序在后台执行</span>
<span class="token keyword">for</span> <span class="token punctuation">{</span>
<span class="token punctuation">}</span>
</code></pre></div><p>运行代码会报错，输出如下：</p> <p><code>fatal error: concurrent map read and map write</code></p> <p>错误信息显示，并发的 map 读和 map 写，也就是说使用了两个并发函数不断地对 map 进行读和写而发生了竞态问题，map 内部会对这种并发操作进行检查并提前发现。</p> <p>需要并发读写时，一般的做法是加锁，但这样性能并不高，Go语言在 1.9 版本中提供了一种效率较高的并发安全的 <code>sync.Map</code>，sync.Map 和 map 不同，不是以语言原生形态提供，而是在 sync 包下的特殊结构。</p> <p>sync.Map 有以下特性：</p> <ul><li>无须初始化，直接声明即可。</li> <li>sync.Map 不能使用 map 的方式进行取值和设置等操作，而是使用 sync.Map 的方法进行调用，Store 表示存储，Load 表示获取，Delete 表示删除。</li> <li>使用 Range 配合一个回调函数进行遍历操作，通过回调函数返回内部遍历出来的值，Range 参数中回调函数的返回值在需要继续迭代遍历时，返回 true，终止迭代遍历时，返回 false。</li></ul> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token punctuation">(</span>
      <span class="token string">&quot;fmt&quot;</span>
      <span class="token string">&quot;sync&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//sync.Map 不能使用 make 创建</span>
    <span class="token keyword">var</span> scene sync<span class="token punctuation">.</span>Map
    <span class="token comment">// 将键值对保存到sync.Map</span>
    <span class="token comment">//sync.Map 将键和值以 interface{} 类型进行保存。</span>
    scene<span class="token punctuation">.</span><span class="token function">Store</span><span class="token punctuation">(</span><span class="token string">&quot;greece&quot;</span><span class="token punctuation">,</span> <span class="token number">97</span><span class="token punctuation">)</span>
    scene<span class="token punctuation">.</span><span class="token function">Store</span><span class="token punctuation">(</span><span class="token string">&quot;london&quot;</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span>
    scene<span class="token punctuation">.</span><span class="token function">Store</span><span class="token punctuation">(</span><span class="token string">&quot;egypt&quot;</span><span class="token punctuation">,</span> <span class="token number">200</span><span class="token punctuation">)</span>
    <span class="token comment">// 从sync.Map中根据键取值</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>scene<span class="token punctuation">.</span><span class="token function">Load</span><span class="token punctuation">(</span><span class="token string">&quot;london&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// 根据键删除对应的键值对</span>
    scene<span class="token punctuation">.</span><span class="token function">Delete</span><span class="token punctuation">(</span><span class="token string">&quot;london&quot;</span><span class="token punctuation">)</span>
    <span class="token comment">// 遍历所有sync.Map中的键值对</span>
    <span class="token comment">//遍历需要提供一个匿名函数，参数为 k、v，类型为 interface{}，每次 Range() 在遍历一个元素时，都会调用这个匿名函数把结果返回。</span>
    scene<span class="token punctuation">.</span><span class="token function">Range</span><span class="token punctuation">(</span><span class="token keyword">func</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> v <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token builtin">bool</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;iterate:&quot;</span><span class="token punctuation">,</span> k<span class="token punctuation">,</span> v<span class="token punctuation">)</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>sync.Map 为了保证并发安全有一些性能损失，因此在非并发情况下，使用 map 相比使用 sync.Map 会有更好的性能。</strong></p> <h1 id="_6-nil"><a href="#_6-nil" class="header-anchor">#</a> 6. nil</h1> <p>在Go语言中，布尔类型的零值（初始值）为 false，数值类型的零值为 0，字符串类型的零值为空字符串<code>&quot;&quot;</code>，而指针、切片、映射、通道、函数和接口的零值则是 nil。</p> <p>nil和其他语言的null是不同的。</p> <p><strong>nil 标识符是不能比较的</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//invalid operation: nil == nil (operator == not defined on nil)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token boolean">nil</span><span class="token operator">==</span><span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>nil 不是关键字或保留字</strong></p> <p>nil 并不是Go语言的关键字或者保留字，也就是说我们可以定义一个名称为 nil 的变量，比如下面这样：</p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token comment">//但不提倡这样做</span>
<span class="token keyword">var</span> <span class="token boolean">nil</span> <span class="token operator">=</span> errors<span class="token punctuation">.</span><span class="token function">New</span><span class="token punctuation">(</span><span class="token string">&quot;my god&quot;</span><span class="token punctuation">)</span>
</code></pre></div><p><strong>nil 没有默认类型</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//error :use of untyped nil</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%T&quot;</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span>
    <span class="token function">print</span><span class="token punctuation">(</span><span class="token boolean">nil</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>不同类型 nil 的指针是一样的</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> arr <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>
    <span class="token keyword">var</span> num <span class="token operator">*</span><span class="token builtin">int</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%p\n&quot;</span><span class="token punctuation">,</span> arr<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%p&quot;</span><span class="token punctuation">,</span> num<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>nil 是 map、slice、pointer、channel、func、interface 的零值</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> m <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">string</span>
    <span class="token keyword">var</span> ptr <span class="token operator">*</span><span class="token builtin">int</span>
    <span class="token keyword">var</span> c <span class="token keyword">chan</span> <span class="token builtin">int</span>
    <span class="token keyword">var</span> sl <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>
    <span class="token keyword">var</span> f <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">var</span> i <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%#v\n&quot;</span><span class="token punctuation">,</span> m<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%#v\n&quot;</span><span class="token punctuation">,</span> ptr<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%#v\n&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%#v\n&quot;</span><span class="token punctuation">,</span> sl<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%#v\n&quot;</span><span class="token punctuation">,</span> f<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Printf</span><span class="token punctuation">(</span><span class="token string">&quot;%#v\n&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>零值是Go语言中变量在声明之后但是未初始化被赋予的该类型的一个默认值。</strong></p> <p><strong>不同类型的 nil 值占用的内存大小可能是不一样的</strong></p> <div class="language-go extra-class"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token punctuation">(</span>
    <span class="token string">&quot;fmt&quot;</span>
    <span class="token string">&quot;unsafe&quot;</span>
<span class="token punctuation">)</span>
<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> p <span class="token operator">*</span><span class="token keyword">struct</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span> p <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment">// 8</span>
    <span class="token keyword">var</span> s <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token builtin">int</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span> s <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment">// 24</span>
    <span class="token keyword">var</span> m <span class="token keyword">map</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">]</span><span class="token builtin">bool</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span> m <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment">// 8</span>
    <span class="token keyword">var</span> c <span class="token keyword">chan</span> <span class="token builtin">string</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span> c <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment">// 8</span>
    <span class="token keyword">var</span> f <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span> f <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment">// 8</span>
    <span class="token keyword">var</span> i <span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span> unsafe<span class="token punctuation">.</span><span class="token function">Sizeof</span><span class="token punctuation">(</span> i <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token comment">// 16</span>
<span class="token punctuation">}</span>
</code></pre></div><p><strong>具体的大小取决于编译器和架构</strong></p> <h1 id="_7-new和make"><a href="#_7-new和make" class="header-anchor">#</a> 7. new和make</h1> <p>make 关键字的主要作用是创建 slice、map 和 Channel 等内置的数据结构，而 new 的主要作用是为类型申请一片内存空间，并返回指向这片内存的指针。</p> <ol><li>make 分配空间后，会进行初始化，new分配的空间被清零</li> <li>new 分配返回的是指针，即类型 *Type。make 返回引用，即 Type；</li> <li>new 可以分配任意类型的数据；</li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/blog/go-study/basic-syntax/4.指针-类型转换.html" class="prev">
        指针-类型转换
      </a></span> <span class="next"><a href="/blog/go-study/basic-syntax/6.语句.html">
        语句
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/blog/assets/js/app.17aef99c.js" defer></script><script src="/blog/assets/js/2.cb836bf6.js" defer></script><script src="/blog/assets/js/1.085f3e10.js" defer></script><script src="/blog/assets/js/71.46a9b726.js" defer></script>
  </body>
</html>
